flowchart TD
%% Node definition rules applied
%% Global entities
A["Ghostty System"]:::top-level
%% Core Components
subgraph Core Components
A1["Terminal Engine"]:::core-full
click A1 "https://github.com/ghostty-org/ghostty/blob/main/src/terminal/Parser.zig"
A2["Input Handling"]:::core
click A2 "https://github.com/ghostty-org/ghostty/tree/main/src/input/"
A3["Text Rendering"]:::core
click A3 "https://github.com/ghostty-org/ghostty/blob/main/src/terminal/ansc.zig"
A4["Embedded Interface"]:::core
click A4 "https://github.com/ghostty-org/ghostty/tree/main/src/lib_vt/"
A5["Dependencies"]:::core
click A5 "https://github.com/ghostty-org/ghostty/tree/main/pkg/harfbuzz/"
A6["Build System"]:::core
click A6 "https://github.com/ghostty-org/ghostty/blob/main/build.zig"
A7["Service Architecture"]:::core
click A7 "https://github.com/ghostty-org/ghostty/blob/main/src/os/main.zig"
A8["Font Rendering"]:::core
click A8 "https://github.com/ghostty-org/ghostty/blob/main/font/shaper/harfbuzz.zig"
end
%% Platform Implementations
subgraph Platform Implementations
subgraph macOS
B1["SwiftUI UI"]:::macos
click B1 "https://github.com/ghostty-org/ghostty/tree/main/Sources/App/"
MetalRenderer["Metal Renderer"]:::metal
click MetalRenderer "https://github.com/ghostty-org/ghostty/blob/main/metal/Pipeline.zig"
Connect "A1 -->|Core APIs| B1"
Connect "A3 -->|Glyphs| MetalRenderer"
Connect "A7 -->|Lifecycle| macOS"
end
subgraph Linux
B2["GTK UI"]:::linux
click B2 "https://github.com/ghostty-org/ghostty/tree/main/src/apprt/gtk/"
GLRenderer["OpenGL Renderer"]:::opengl
click GLRenderer "https://github.com/ghostty-org/ghostty/tree/main/src/renderer/opengl/"
Connect "A2 -->|Input| B2"
Connect "A3 -->|Fonts| GLRenderer"
Connect "A5 -->|Dependencies| GLRenderer"
end
subgraph Windows
B3["Win32 API"]:::windows
click B3 "https://github.com/ghostty-org/ghostty/tree/main/src/os/windows/"
SoftwareRenderer["Software Fallback"]:::windows
click SoftwareRenderer "https://github.com/ghostty-org/ghostty/blob/main/src/terminal/bitmap_allocator.zig"
Connect "B3 -->|OS APIs| SoftwareRenderer"
end
end
%% Rendering Chain
Connect "A3 -->|Textâ†’Glyphs| A8"
Connect "A8 -->|Font Cache| A5"
Connect "A3 -->|Render| A7"
Connect "A7 -->|Tooling| A6"
%% Error Handling
errorCluster[Error Boundaries]
Connect "A1 -->|Crash| errorCluster"
Connect "A7 -->|Recovery| errorCluster"
%% Cross-cutting concerns
UIFonts[Fonts System]
click UIFonts "https://github.com/ghostty-org/ghostty/blob/main/src/font/discovery.zig"
Connect "UIFonts --> A5"
Connect "UIFonts --> B1"
Connect "UIFonts --> B2"
%% Service Layer
ServiceThread["IO Thread"]:::service
click ServiceThread "https://github.com/ghostty-org/ghostty/blob/main/src/os/args.zig"
Connect "A2 -->|Input| ServiceThread"
Connect "ServiceThread --> A7"
%% Layout
orient TD
classDef core fill:#4CAF50,stroke:#333,stroke-width:2px,color:#fff
classDef macos fill:#3366cc,stroke:#333,stroke-width:2px,color:#fff
classDef linux fill:#6666cc,stroke:#333,stroke-width:2px,color:#fff
classDef windows fill:#cc3333,stroke:#333,stroke-width:2px,color:#fff
%% Composition
subgraph Rendering Stack
A3 --> A8
A8 --> A5
A5 --> B1
A5 --> B2
A5 --> B3
end